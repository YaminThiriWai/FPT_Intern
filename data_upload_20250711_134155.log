2025-07-11 13:41:55,594 - INFO - DB engine created successfully
2025-07-11 13:41:55,595 - INFO - === OPTIMIZED DATA UPLOAD WORKFLOW STARTED ===
2025-07-11 13:42:12,148 - INFO - Loaded Excel: 101929 rows, 17 columns
2025-07-11 13:42:12,148 - INFO - Excel columns: ['Name', 'Server', 'Storage', 'Job Type', 'Job Status', 'Percent Complete', 'Start Time', 'End Time', 'Elapsed Time', 'Byte Count', 'Job Rate', 'Error Code', 'Deduplication Ratio', 'Selections', 'Backup Method', 'Calculate Elapsed Time', 'System']
2025-07-11 13:42:12,148 - INFO - Starting comprehensive data cleaning and transformation
2025-07-11 13:42:12,149 - INFO - Cleaning NaN values across all columns...
2025-07-11 13:42:18,347 - INFO - Total NaN representations cleaned: 0
2025-07-11 13:42:18,510 - INFO - Moved 3777 misplaced backup method values from 'Selections' to 'Backup Method'
2025-07-11 13:42:18,583 - INFO - Fixing 3622 rows with 'Partially Selected' in Deduplication Ratio
2025-07-11 13:42:18,593 - INFO - System column value counts before filtering: {'Old': 85055, 'New': 16874}
2025-07-11 13:42:18,697 - INFO - System filtering: Kept 16874 rows, dropped 85055 rows
2025-07-11 13:42:18,876 - INFO - SQL table columns: ['Name', 'Server', 'Storage', 'Job Type', 'Job Status', 'Percent Complete', 'Start Time', 'End Time', 'Elapsed Time', 'Byte Count', 'Job Rate', 'Error Code', 'Deduplication Ratio', 'Selections', 'Backup Method', 'Calculate Elapsed Time', 'System', 'ElapsedTimeSeconds', 'ByteCountBytes', 'JobRateBytesPerSec', 'CalculatedElapsedTimeSeconds']
2025-07-11 13:42:18,887 - INFO - Validated columns: 17 columns retained
2025-07-11 13:42:18,887 - INFO - Transforming data types based on SQL schema...
2025-07-11 13:42:18,887 - INFO - Processing column Name (SQL type: nvarchar)
2025-07-11 13:42:18,899 - INFO - Processing column Server (SQL type: nvarchar)
2025-07-11 13:42:18,910 - INFO - Processing column Storage (SQL type: nvarchar)
2025-07-11 13:42:18,923 - INFO - Processing column Job Type (SQL type: nvarchar)
2025-07-11 13:42:18,935 - INFO - Processing column Job Status (SQL type: nvarchar)
2025-07-11 13:42:18,948 - INFO - Processing column Percent Complete (SQL type: float)
2025-07-11 13:42:18,948 - INFO - Processing column Start Time (SQL type: datetime)
2025-07-11 13:42:18,956 - INFO - Processing column End Time (SQL type: datetime)
2025-07-11 13:42:18,962 - INFO - Processing column Elapsed Time (SQL type: nvarchar)
2025-07-11 13:42:18,992 - INFO - Processing column Byte Count (SQL type: nvarchar)
2025-07-11 13:42:19,004 - INFO - Processing column Job Rate (SQL type: nvarchar)
2025-07-11 13:42:19,017 - INFO - Processing column Error Code (SQL type: nvarchar)
2025-07-11 13:42:19,028 - INFO - Processing column Deduplication Ratio (SQL type: nvarchar)
2025-07-11 13:42:19,039 - INFO - Processing column Selections (SQL type: nvarchar)
2025-07-11 13:42:19,051 - INFO - Processing column Backup Method (SQL type: varchar)
2025-07-11 13:42:19,061 - INFO - Processing column Calculate Elapsed Time (SQL type: nvarchar)
2025-07-11 13:42:19,074 - INFO - Processing column System (SQL type: nvarchar)
2025-07-11 13:42:19,086 - INFO - Data type transformation completed
2025-07-11 13:42:19,087 - INFO - Calculating derived columns...
2025-07-11 13:42:19,249 - INFO - DataFrame reordered to 21 expected columns
2025-07-11 13:42:19,275 - INFO - Final Name: 0 NULL values (0.0%)
2025-07-11 13:42:19,276 - INFO - Final Server: 0 NULL values (0.0%)
2025-07-11 13:42:19,278 - INFO - Final Storage: 108 NULL values (0.6%)
2025-07-11 13:42:19,279 - INFO - Final Job Type: 0 NULL values (0.0%)
2025-07-11 13:42:19,280 - INFO - Final Job Status: 0 NULL values (0.0%)
2025-07-11 13:42:19,281 - INFO - Final Percent Complete: 3 NULL values (0.0%)
2025-07-11 13:42:19,281 - INFO - Final Start Time: 0 NULL values (0.0%)
2025-07-11 13:42:19,282 - INFO - Final End Time: 0 NULL values (0.0%)
2025-07-11 13:42:19,284 - INFO - Final Elapsed Time: 0 NULL values (0.0%)
2025-07-11 13:42:19,285 - INFO - Final Byte Count: 0 NULL values (0.0%)
2025-07-11 13:42:19,287 - INFO - Final Job Rate: 32 NULL values (0.2%)
2025-07-11 13:42:19,290 - INFO - Final Error Code: 16703 NULL values (99.0%)
2025-07-11 13:42:19,291 - INFO - Final Deduplication Ratio: 16874 NULL values (100.0%)
2025-07-11 13:42:19,292 - INFO - Final Selections: 13785 NULL values (81.7%)
2025-07-11 13:42:19,294 - INFO - Final Backup Method: 13793 NULL values (81.7%)
2025-07-11 13:42:19,295 - INFO - Final Calculate Elapsed Time: 0 NULL values (0.0%)
2025-07-11 13:42:19,297 - INFO - Final System: 0 NULL values (0.0%)
2025-07-11 13:42:19,298 - INFO - Final ElapsedTimeSeconds: 15 NULL values (0.1%)
2025-07-11 13:42:19,299 - INFO - Final ByteCountBytes: 36 NULL values (0.2%)
2025-07-11 13:42:19,300 - INFO - Final JobRateBytesPerSec: 4429 NULL values (26.2%)
2025-07-11 13:42:19,301 - INFO - Final CalculatedElapsedTimeSeconds: 489 NULL values (2.9%)
2025-07-11 13:42:19,301 - INFO - Data cleaning and transformation completed
2025-07-11 13:42:50,816 - INFO - Truncated table dbo.FPTCOM_Sua (had 15770 rows)
2025-07-11 13:42:50,817 - INFO - Starting upload of 16874 rows to FPTCOM_Sua
2025-07-11 13:42:50,817 - INFO - Sample data being uploaded:
2025-07-11 13:42:50,819 - INFO -   Name: ['FISHCM_HO_AF-Duplicate INCREMENTAL', 'FISHCM_HO_AF-Incremental', 'FISHCM_HO_PPD_XNK-Duplicate to HUB DC_INCREMENTAL']
2025-07-11 13:42:50,821 - INFO -   Server: ['10.86.30.201', '10.86.30.201', '10.86.30.201']
2025-07-11 13:42:50,823 - INFO -   Storage: ['FISHCM_HO_FAF_SITE 2', 'FISHCM_HO_FAF_SITE 1', 'FISHCM_HO_PPD_XNK_HUB DC_Media2']
2025-07-11 13:42:50,825 - INFO -   Job Type: ['Duplicate', 'Backup', 'Duplicate']
2025-07-11 13:42:50,826 - INFO -   Job Status: ['Successful', 'Successful', 'Successful']
2025-07-11 13:42:51,902 - INFO - Successfully uploaded 16874 rows to FPTCOM_Sua
2025-07-11 13:42:51,911 - INFO - Upload verified: 16874 rows in table
2025-07-11 13:42:51,972 - INFO - Sample of uploaded data:
                                                Name        Server  ... JobRateBytesPerSec CalculatedElapsedTimeSeconds
0  FISHCM_HO_AF-Verify (Duplicate)_INCREMENTAL_To...  10.86.30.201  ...               None                          107
1       FISHCM_HO_AF-Duplicate_INCREMENTAL_TO_MEDIA2  10.86.30.201  ...               None                          622
2  FISHCM_HO_AF-Verify_INCREMENTAL (Duplicate)_To...  10.86.30.201  ...               None                          418

[3 rows x 21 columns]
2025-07-11 13:42:51,978 - INFO - === WORKFLOW COMPLETED SUCCESSFULLY ===
2025-07-11 13:42:51,979 - INFO - Database engine disposed
2025-07-11 13:42:51,979 - INFO - Database engine disposed
