2025-07-04 17:11:47,950 - INFO - DB engine created successfully
2025-07-04 17:11:47,951 - INFO - === OPTIMIZED DATA UPLOAD WORKFLOW STARTED ===
2025-07-04 17:12:02,902 - INFO - Loaded Excel: 100825 rows, 17 columns
2025-07-04 17:12:02,903 - INFO - Excel columns: ['Name', 'Server', 'Storage', 'Job Type', 'Job Status', 'Percent Complete', 'Start Time', 'End Time', 'Elapsed Time', 'Byte Count', 'Job Rate', 'Error Code', 'Deduplication Ratio', 'Selections', 'Backup Method', 'Calculate Elapsed Time', 'System']
2025-07-04 17:12:02,903 - INFO - Starting comprehensive data cleaning and transformation
2025-07-04 17:12:02,904 - INFO - Cleaning NaN values across all columns...
2025-07-04 17:12:08,853 - INFO - Total NaN representations cleaned: 0
2025-07-04 17:12:09,035 - INFO - Moved 3617 misplaced backup method values from 'Selections' to 'Backup Method'
2025-07-04 17:12:09,110 - INFO - Fixing 3462 rows with 'Partially Selected' in Deduplication Ratio
2025-07-04 17:12:09,120 - INFO - System column value counts before filtering: {'Old': 85055, 'New': 14701, 'FISHCM_HO_FAF_HUB_DC_MEDIA2': 62, 'FISHCM_HO_PPD_XNK_FPTVINACCS_SITE 1': 62, 'FISHCM_HO_PPD_XNK_FPTVINACCS_SITE 2': 62, 'FISHCM_ISO_CMM_SITE 1': 62, 'FISHCM_HO_PPD_XNK_HUB DC_Media2': 61, 'FISHCM_HO_PPD_POMAN_SITE 1': 61, 'FISHCM_HO_FAF_SITE 1': 61, 'FISHCM_ISO_CMM_HUB DC_Media2': 60, 'FISHCM_HO_PPD_XNK_SITE 1': 60, 'FISHCM_HO_PPD_XNK_SITE 2': 57, 'FISHCM_ISO_CMM_Media1': 52, 'FISHCM_HO_PPD_XNK_Media1': 50, 'FISHCM_HO_FAF_SITE 2': 50, 'FISHCM_ISO-CMM_SITE 2': 50, 'FISHCM_HO_FAF_MEDIA1': 42, 'FISHCM_HO_PPD_POMAN_SITE 2': 38, 'FISHCM_HO_PPD_POMAN_Media1': 36, 'FISHCM_HO_PPD_POMAN_Media2': 26, 'FISHCM_HO_PPD_POMAN_SITE 3': 25, 'FISHCM_HO_FAF_MEDIA2': 21, 'FISHCM_HO_FAF_SITE 3': 12, 'FISHCM_ISO-CMM_SITE 3': 12, 'FISHCM_HO_PPD_XNK_Media2': 12, 'FISHCM_HO_PPD_POMAN_HUB_DC_Media2': 10, 'FISHCM_ISO_CMM_Media2': 10, 'FISHCM_HO_PPD_XNK_SITE 3': 7, None: 5, 'FISHCM_ISO_CMM_HUB DC_Media3': 2, 'FISHCM_HO_PPD_XNK_HUB DC_Media3': 1}
2025-07-04 17:12:09,228 - INFO - System filtering: Kept 14701 rows, dropped 86124 rows
2025-07-04 17:12:09,335 - INFO - SQL table columns: ['Name', 'Server', 'Storage', 'Job Type', 'Job Status', 'Percent Complete', 'Start Time', 'End Time', 'Elapsed Time', 'Byte Count', 'Job Rate', 'Error Code', 'Deduplication Ratio', 'Selections', 'Backup Method', 'Calculate Elapsed Time', 'System', 'ElapsedTimeSeconds', 'ByteCountBytes', 'JobRateBytesPerSec', 'CalculatedElapsedTimeSeconds']
2025-07-04 17:12:09,343 - INFO - Validated columns: 17 columns retained
2025-07-04 17:12:09,344 - INFO - Transforming data types based on SQL schema...
2025-07-04 17:12:09,344 - INFO - Processing column Name (SQL type: nvarchar)
2025-07-04 17:12:09,353 - INFO - Processing column Server (SQL type: nvarchar)
2025-07-04 17:12:09,363 - INFO - Processing column Storage (SQL type: nvarchar)
2025-07-04 17:12:09,373 - INFO - Processing column Job Type (SQL type: nvarchar)
2025-07-04 17:12:09,384 - INFO - Processing column Job Status (SQL type: nvarchar)
2025-07-04 17:12:09,395 - INFO - Processing column Percent Complete (SQL type: float)
2025-07-04 17:12:09,395 - INFO - Processing column Start Time (SQL type: datetime)
2025-07-04 17:12:09,405 - INFO - Processing column End Time (SQL type: datetime)
2025-07-04 17:12:09,410 - INFO - Processing column Elapsed Time (SQL type: nvarchar)
2025-07-04 17:12:09,431 - INFO - Processing column Byte Count (SQL type: nvarchar)
2025-07-04 17:12:09,441 - INFO - Processing column Job Rate (SQL type: nvarchar)
2025-07-04 17:12:09,451 - INFO - Processing column Error Code (SQL type: nvarchar)
2025-07-04 17:12:09,459 - INFO - Processing column Deduplication Ratio (SQL type: nvarchar)
2025-07-04 17:12:09,468 - INFO - Processing column Selections (SQL type: nvarchar)
2025-07-04 17:12:09,482 - INFO - Processing column Backup Method (SQL type: varchar)
2025-07-04 17:12:09,491 - INFO - Processing column Calculate Elapsed Time (SQL type: nvarchar)
2025-07-04 17:12:09,503 - INFO - Processing column System (SQL type: nvarchar)
2025-07-04 17:12:09,513 - INFO - Data type transformation completed
2025-07-04 17:12:09,514 - INFO - Calculating derived columns...
2025-07-04 17:12:09,671 - INFO - DataFrame reordered to 21 expected columns
2025-07-04 17:12:09,733 - INFO - Final Name: 0 NULL values (0.0%)
2025-07-04 17:12:09,735 - INFO - Final Server: 0 NULL values (0.0%)
2025-07-04 17:12:09,736 - INFO - Final Storage: 100 NULL values (0.7%)
2025-07-04 17:12:09,738 - INFO - Final Job Type: 0 NULL values (0.0%)
2025-07-04 17:12:09,739 - INFO - Final Job Status: 0 NULL values (0.0%)
2025-07-04 17:12:09,740 - INFO - Final Percent Complete: 3 NULL values (0.0%)
2025-07-04 17:12:09,741 - INFO - Final Start Time: 0 NULL values (0.0%)
2025-07-04 17:12:09,742 - INFO - Final End Time: 0 NULL values (0.0%)
2025-07-04 17:12:09,743 - INFO - Final Elapsed Time: 0 NULL values (0.0%)
2025-07-04 17:12:09,745 - INFO - Final Byte Count: 0 NULL values (0.0%)
2025-07-04 17:12:09,746 - INFO - Final Job Rate: 28 NULL values (0.2%)
2025-07-04 17:12:09,747 - INFO - Final Error Code: 14542 NULL values (98.9%)
2025-07-04 17:12:09,747 - INFO - Final Deduplication Ratio: 14701 NULL values (100.0%)
2025-07-04 17:12:09,748 - INFO - Final Selections: 11927 NULL values (81.1%)
2025-07-04 17:12:09,749 - INFO - Final Backup Method: 11935 NULL values (81.2%)
2025-07-04 17:12:09,750 - INFO - Final Calculate Elapsed Time: 0 NULL values (0.0%)
2025-07-04 17:12:09,751 - INFO - Final System: 0 NULL values (0.0%)
2025-07-04 17:12:09,752 - INFO - Final ElapsedTimeSeconds: 15 NULL values (0.1%)
2025-07-04 17:12:09,752 - INFO - Final ByteCountBytes: 36 NULL values (0.2%)
2025-07-04 17:12:09,753 - INFO - Final JobRateBytesPerSec: 3408 NULL values (23.2%)
2025-07-04 17:12:09,753 - INFO - Final CalculatedElapsedTimeSeconds: 423 NULL values (2.9%)
2025-07-04 17:12:09,753 - INFO - Data cleaning and transformation completed
2025-07-04 17:12:12,710 - INFO - Truncated table dbo.FPTCOM_Sua (had 10 rows)
2025-07-04 17:12:12,712 - INFO - Starting upload of 14701 rows to FPTCOM_Sua
2025-07-04 17:12:12,712 - INFO - Sample data being uploaded:
2025-07-04 17:12:12,714 - INFO -   Name: ['FISHCM_HO_AF-Duplicate INCREMENTAL', 'FISHCM_HO_AF-Incremental', 'FISHCM_HO_PPD_XNK-Duplicate to HUB DC_INCREMENTAL']
2025-07-04 17:12:12,717 - INFO -   Server: ['10.86.30.201', '10.86.30.201', '10.86.30.201']
2025-07-04 17:12:12,718 - INFO -   Storage: ['FISHCM_HO_FAF_SITE 2', 'FISHCM_HO_FAF_SITE 1', 'FISHCM_HO_PPD_XNK_HUB DC_Media2']
2025-07-04 17:12:12,720 - INFO -   Job Type: ['Duplicate', 'Backup', 'Duplicate']
2025-07-04 17:12:12,721 - INFO -   Job Status: ['Successful', 'Successful', 'Successful']
2025-07-04 17:12:13,691 - INFO - Successfully uploaded 14701 rows to FPTCOM_Sua
2025-07-04 17:12:13,705 - INFO - Upload verified: 14701 rows in table
2025-07-04 17:12:13,757 - INFO - Sample of uploaded data:
                                                Name        Server  ... JobRateBytesPerSec CalculatedElapsedTimeSeconds
0  FISHCM_HO_AF-Verify (Duplicate)_INCREMENTAL_To...  10.86.30.201  ...               None                            1
1  FISHCM_HO_AF-Verify_INCREMENTAL (Duplicate)_To...  10.86.30.201  ...               None                           34
2       FISHCM_HO_AF-Duplicate_INCREMENTAL_TO_MEDIA2  10.86.30.201  ...               None                           38

[3 rows x 21 columns]
2025-07-04 17:12:13,758 - INFO - === WORKFLOW COMPLETED SUCCESSFULLY ===
2025-07-04 17:12:13,759 - INFO - Database engine disposed
2025-07-04 17:12:13,761 - INFO - Database engine disposed
