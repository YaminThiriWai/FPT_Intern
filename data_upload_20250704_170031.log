2025-07-04 17:00:31,969 - INFO - DB engine created successfully
2025-07-04 17:00:31,969 - INFO - === OPTIMIZED DATA UPLOAD WORKFLOW STARTED ===
2025-07-04 17:00:32,489 - INFO - Loaded Excel: 1069 rows, 17 columns
2025-07-04 17:00:32,490 - INFO - Excel columns: ['Name', 'Server', 'Storage', 'Job Type', 'Job Status', 'Percent Complete', 'Start Time', 'End Time', 'Elapsed Time', 'Byte Count', 'Job Rate', 'Error Code', 'Deduplication Ratio', 'Selections', 'Backup Method', 'Calculate Elapsed Time', 'System']
2025-07-04 17:00:32,490 - INFO - Starting comprehensive data cleaning and transformation
2025-07-04 17:00:32,491 - INFO - Cleaning NaN values across all columns...
2025-07-04 17:00:32,592 - INFO - Total NaN representations cleaned: 0
2025-07-04 17:00:32,602 - INFO - Moved 155 misplaced backup method values from 'Selections' to 'Backup Method'
2025-07-04 17:00:32,605 - INFO - Fixing 155 rows with 'Partially Selected' in Deduplication Ratio
2025-07-04 17:00:32,607 - INFO - System column value counts before filtering: {'New': 1069}
2025-07-04 17:00:32,609 - INFO - System filtering: Kept 1069 rows, dropped 0 rows
2025-07-04 17:00:32,715 - INFO - SQL table columns: ['Name', 'Server', 'Storage', 'Job Type', 'Job Status', 'Percent Complete', 'Start Time', 'End Time', 'Elapsed Time', 'Byte Count', 'Job Rate', 'Error Code', 'Deduplication Ratio', 'Selections', 'Backup Method', 'Calculate Elapsed Time', 'System', 'ElapsedTimeSeconds', 'ByteCountBytes', 'JobRateBytesPerSec', 'CalculatedElapsedTimeSeconds']
2025-07-04 17:00:32,717 - INFO - Validated columns: 17 columns retained
2025-07-04 17:00:32,717 - INFO - Transforming data types based on SQL schema...
2025-07-04 17:00:32,717 - INFO - Processing column Name (SQL type: nvarchar)
2025-07-04 17:00:32,718 - INFO - Processing column Server (SQL type: nvarchar)
2025-07-04 17:00:32,719 - INFO - Processing column Storage (SQL type: nvarchar)
2025-07-04 17:00:32,721 - INFO - Processing column Job Type (SQL type: nvarchar)
2025-07-04 17:00:32,722 - INFO - Processing column Job Status (SQL type: nvarchar)
2025-07-04 17:00:32,723 - INFO - Processing column Percent Complete (SQL type: float)
2025-07-04 17:00:32,723 - INFO - Processing column Start Time (SQL type: datetime)
2025-07-04 17:00:32,727 - INFO - Processing column End Time (SQL type: datetime)
2025-07-04 17:00:32,730 - INFO - Processing column Elapsed Time (SQL type: nvarchar)
2025-07-04 17:00:32,734 - INFO - Processing column Byte Count (SQL type: nvarchar)
2025-07-04 17:00:32,736 - INFO - Processing column Job Rate (SQL type: nvarchar)
2025-07-04 17:00:32,738 - INFO - Processing column Error Code (SQL type: nvarchar)
2025-07-04 17:00:32,739 - INFO - Processing column Deduplication Ratio (SQL type: nvarchar)
2025-07-04 17:00:32,741 - INFO - Processing column Selections (SQL type: nvarchar)
2025-07-04 17:00:32,743 - INFO - Processing column Backup Method (SQL type: varchar)
2025-07-04 17:00:32,744 - INFO - Processing column Calculate Elapsed Time (SQL type: nvarchar)
2025-07-04 17:00:32,746 - INFO - Processing column System (SQL type: nvarchar)
2025-07-04 17:00:32,748 - INFO - Data type transformation completed
2025-07-04 17:00:32,748 - INFO - Calculating derived columns...
2025-07-04 17:00:32,762 - INFO - DataFrame reordered to 21 expected columns
2025-07-04 17:00:32,767 - INFO - Final Name: 0 NULL values (0.0%)
2025-07-04 17:00:32,768 - INFO - Final Server: 0 NULL values (0.0%)
2025-07-04 17:00:32,768 - INFO - Final Storage: 5 NULL values (0.5%)
2025-07-04 17:00:32,769 - INFO - Final Job Type: 0 NULL values (0.0%)
2025-07-04 17:00:32,769 - INFO - Final Job Status: 0 NULL values (0.0%)
2025-07-04 17:00:32,769 - INFO - Final Percent Complete: 0 NULL values (0.0%)
2025-07-04 17:00:32,770 - INFO - Final Start Time: 0 NULL values (0.0%)
2025-07-04 17:00:32,770 - INFO - Final End Time: 0 NULL values (0.0%)
2025-07-04 17:00:32,770 - INFO - Final Elapsed Time: 0 NULL values (0.0%)
2025-07-04 17:00:32,771 - INFO - Final Byte Count: 0 NULL values (0.0%)
2025-07-04 17:00:32,771 - INFO - Final Job Rate: 2 NULL values (0.2%)
2025-07-04 17:00:32,772 - INFO - Final Error Code: 1062 NULL values (99.3%)
2025-07-04 17:00:32,772 - INFO - Final Deduplication Ratio: 1069 NULL values (100.0%)
2025-07-04 17:00:32,773 - INFO - Final Selections: 914 NULL values (85.5%)
2025-07-04 17:00:32,773 - INFO - Final Backup Method: 914 NULL values (85.5%)
2025-07-04 17:00:32,773 - INFO - Final Calculate Elapsed Time: 0 NULL values (0.0%)
2025-07-04 17:00:32,774 - INFO - Final System: 0 NULL values (0.0%)
2025-07-04 17:00:32,774 - INFO - Final ElapsedTimeSeconds: 0 NULL values (0.0%)
2025-07-04 17:00:32,775 - INFO - Final ByteCountBytes: 0 NULL values (0.0%)
2025-07-04 17:00:32,775 - INFO - Final JobRateBytesPerSec: 470 NULL values (44.0%)
2025-07-04 17:00:32,776 - INFO - Final CalculatedElapsedTimeSeconds: 35 NULL values (3.3%)
2025-07-04 17:00:32,776 - INFO - Data cleaning and transformation completed
2025-07-04 17:00:35,096 - INFO - Truncated table dbo.FPTCOM_Sua (had 0 rows)
2025-07-04 17:00:35,101 - INFO - Starting upload of 1069 rows to FPTCOM_Sua
2025-07-04 17:00:35,101 - INFO - Sample data being uploaded:
2025-07-04 17:00:35,103 - INFO -   Name: ['FISHCM_HO_AF-Verify (Duplicate)_INCREMENTAL_To_MEDIA2', 'FISHCM_HO_AF-Duplicate_INCREMENTAL_TO_MEDIA2', 'FISHCM_HO_AF-Verify_INCREMENTAL (Duplicate)_To_Media1']
2025-07-04 17:00:35,105 - INFO -   Server: ['10.86.30.201', '10.86.30.201', '10.86.30.201']
2025-07-04 17:00:35,106 - INFO -   Storage: ['FISHCM_HO_FAF_HUB_DC_MEDIA2', 'FISHCM_HO_FAF_HUB_DC_MEDIA2', 'FISHCM_HO_FAF_MEDIA1']
2025-07-04 17:00:35,107 - INFO -   Job Type: ['Verify', 'Duplicate', 'Verify']
2025-07-04 17:00:35,108 - INFO -   Job Status: ['Successful', 'Successful', 'Successful']
2025-07-04 17:00:35,109 - ERROR - Upload failed: NDFrame.to_sql() got an unexpected keyword argument 'nrows'
2025-07-04 17:00:35,109 - ERROR - DataFrame info for debugging:
2025-07-04 17:00:35,110 - ERROR - Shape: (1069, 21)
2025-07-04 17:00:35,110 - ERROR - Columns: ['Name', 'Server', 'Storage', 'Job Type', 'Job Status', 'Percent Complete', 'Start Time', 'End Time', 'Elapsed Time', 'Byte Count', 'Job Rate', 'Error Code', 'Deduplication Ratio', 'Selections', 'Backup Method', 'Calculate Elapsed Time', 'System', 'ElapsedTimeSeconds', 'ByteCountBytes', 'JobRateBytesPerSec', 'CalculatedElapsedTimeSeconds']
2025-07-04 17:00:35,111 - ERROR - Data types: {'Name': dtype('O'), 'Server': dtype('O'), 'Storage': dtype('O'), 'Job Type': dtype('O'), 'Job Status': dtype('O'), 'Percent Complete': dtype('int64'), 'Start Time': dtype('<M8[ns]'), 'End Time': dtype('<M8[ns]'), 'Elapsed Time': dtype('O'), 'Byte Count': dtype('O'), 'Job Rate': dtype('O'), 'Error Code': dtype('O'), 'Deduplication Ratio': dtype('O'), 'Selections': dtype('O'), 'Backup Method': dtype('O'), 'Calculate Elapsed Time': dtype('O'), 'System': dtype('O'), 'ElapsedTimeSeconds': dtype('int64'), 'ByteCountBytes': dtype('int64'), 'JobRateBytesPerSec': dtype('float64'), 'CalculatedElapsedTimeSeconds': dtype('float64')}
2025-07-04 17:00:35,112 - ERROR - === WORKFLOW FAILED ===: NDFrame.to_sql() got an unexpected keyword argument 'nrows'
2025-07-04 17:00:35,114 - INFO - Database engine disposed
2025-07-04 17:00:35,114 - ERROR - Main execution failed: NDFrame.to_sql() got an unexpected keyword argument 'nrows'
2025-07-04 17:00:35,115 - INFO - Database engine disposed
